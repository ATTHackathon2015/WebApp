<!DOCTYPE html>
<html>
  
  <head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.0/css/materialize.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style type="text/css">
      div#googleMap {
          margin: 0 auto 0 auto;
      }
      h1 {
        margin-top: 0;
      }
      #holder {
        margin: 40px;
      }
      
      .mdi-navigation-arrow-drop-down {
        display: none;
      }
    </style>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.96.1/js/materialize.min.js"></script>
    <script src="http://maps.googleapis.com/maps/api/js"></script>
    <script>
      var lat = 33.777909;
      var long = -84.389315;
      var acc;
      var map;
      var lost_markers = [];
      var found_markers = [];
      var lost_marker_index;
      var found_marker_index;
      var marker_type;
      var pinImage;
      // var marker;
      // var infowindow;
      
      // navigator.geolocation.getCurrentPosition(GetLocation);
      // function GetLocation(location) {
      //     lat = location.coords.latitude;
      //     long = location.coords.longitude;
      //     acc = location.coords.accuracy;
      // }
      function initialize() {
          lost_marker_index = 0;
          found_marker_index = 0;
          marker_type = 0;
          var mapProp = {
              center:new google.maps.LatLng(lat,long),
              zoom:17,
              mapTypeId:google.maps.MapTypeId.ROADMAP
          };
          map=new google.maps.Map(document.getElementById("googleMap"), mapProp);
          map.addListener('click', function(event) {
              placeMarker(event.latLng);
          });
      
      
      }
      function placeMarker(location) {
          if (marker_type != 0) {
              var marker = new google.maps.Marker({
                position: location,
                icon: pinImage,
                map: map,
              });
              var infowindow = new google.maps.InfoWindow({
                content: "Item name: " + document.getElementById("item_name").value + '<br>' + "Description: " + document.getElementById("description").value + '<br>' +
                 "Time: " + document.getElementById("time_found").value + '<br>' + "Contact: " + document.getElementById("phone").value,
                 map:map
              });
              infowindow.open(map,marker);
      
              if (marker_type == 1) {
                  lost_markers[lost_marker_index] = marker;
                  lost_marker_index = marker_index + 1;
      
              } else if (marker_type == 2) {
                  found_markers[found_marker_index] = marker;
                  found_marker_index = marker_index + 1;
      
              }
      
          }
          google.maps.event.addListener(marker, 'mouseover', function() {
              infowindow.open(map, this);
          });
      
          // assuming you also want to hide the infowindow when user mouses-out
          google.maps.event.addListener(marker, 'mouseout', function() {
              infowindow.close();
          });
      
      
      }
      
      function setMarkerType(val) {
          // document.getElementById("title").innerHTML = "Lost";
          if (val == "Lost") {
              marker_type = 1;
              pinImage = new google.maps.MarkerImage('http://maps.google.com/mapfiles/ms/icons/red-dot.png');
              document.getElementById("title").innerHTML = "Lost";
          } else if (val == "Found") {
              marker_type = 2;
              pinImage = new google.maps.MarkerImage('http://maps.google.com/mapfiles/ms/icons/green-dot.png');
              document.getElementById("title").innerHTML = "Found";
          } else {
              marker_type = 0;
          }
      }
      
      
      google.maps.event.addDomListener(window, 'load', initialize);
      
      $(document).ready(function() {
          $('select').material_select();
      });
    </script>
  </head>
  
  <body>
    <div id="holder" class="">
      <div class="row">
        <div class="col s12">
           <h1 id="title">Lost and Found</h1>
        </div>
      </div>
      <div class="row">
        <div class="col s3">
          <div class="row">
            <div class="col s12 card blue-grey darken-1">
              <div class="card-content white-text">
                <span class="card-title">Add Item</span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="input-field col s12">
              <input placeholder="Placeholder" id="item_name" type="text" class="validate">
              <label for="item_name">Item name</label>
            </div>
          </div>
          <div class="row">
            <div class="input-field col s12">
              <textarea id="description" class="materialize-textarea"></textarea>
              <label for="description">Description</label>
            </div>
          </div>
          <div class="row">
            <div class="input-field col s12">
              <input id="phone" type="tel" class="validate">
              <label for="phone">Phone</label>
            </div>
          </div>
          <div class="row">
            <div class="input-field col s12">
              <select>
                <option value="" disabled selected onchange="setMarkerType(this.value)">Choose your option</option>
                <option value="lost">Lost</option>
                <option value="found">Found</option>
              </select>
              <label>Lost or Found</label>
            </div>
          </div>
        </div>
        <div class="col s9">
          <div id="googleMap" style="height:700px;"></div>
        </div>
      </div>
    </div>
  </body>

</html>